sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/UIComponent","sap/m/library","sap/ui/export/Spreadsheet","sap/m/MessageToast"],function(e,t,r,o,a){"use strict";var l=r.URLHelper;return e.extend("com.salesbom.culligan.salesbomdisplay.controller.BaseController",{getRouter:function(){return t.getRouterFor(this)},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,t){return this.getView().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},onShareEmailPress:function(){var e=this.getModel("objectView")||this.getModel("worklistView");l.triggerEmail(null,e.getProperty("/shareSendEmailSubject"),e.getProperty("/shareSendEmailMessage"))},onExcelDownload:function(e){var t,r,l,n;t=e.createColumnConfig();r=e.getView().getModel("OPM").getProperty("/");var s=new Date;l={workbook:{columns:t},dataSource:r,showProgress:false,fileName:"Bill Of Material Report_"+s.getUTCDate()+"-"+(s.getUTCMonth()+1)+"-"+s.getUTCFullYear()};n=new o(l);n.build().then(function(){a.show("Excel export has finished")}).finally(function(){n.destroy()})},createColumnConfig:function(){return[{label:"Header Material",property:"mat"},{label:"Father Standard Cost",property:"msp"},{label:"Level",property:"lvl"},{label:"Is Assembly",property:"asm"},{label:"BOM Usage",property:"usg"},{label:"BOM Item No",property:"itm"},{label:"BOM Component",property:"bom"},{label:"Component Description",property:"des"},{label:"BOM Quantity",property:"qty"},{label:"Component Standard Cost",property:"stc"},{label:"per Unit Standard Cost",property:"psc"},{label:"Total Standard Cost",property:"tsc"}]},onSalesExcelDownload:function(e){var t,r,l,n;t=e.salescreateColumnConfig();r=e.getView().getModel("XLSX").getProperty("/");var s=new Date;l={workbook:{columns:t},dataSource:r,showProgress:false,fileName:"Sales Order BOM Report_"+s.getUTCDate()+"-"+(s.getUTCMonth()+1)+"-"+s.getUTCFullYear()};n=new o(l);n.build().then(function(){a.show("Excel export has finished")}).finally(function(){n.destroy()})},salescreateColumnConfig:function(){return[{label:"Sales Order",property:"SalesOrder"},{label:"Sales Order Line Item",property:"SalesOrderItem"},{label:"Material",property:"Material"},{label:"Category",property:"SalesOrderItemCategory"},{label:"Plant",property:"ProductionPlant"},{label:"Material Description",property:"SalesOrderItemText"},{label:"Quantity",property:"RequestedQuantity"},{label:"Standard Cost",property:"StandardCost"},{label:"Calculated Standard Cost",property:"CalculatedStdCost"}]},addHistoryEntry:function(){var e=[];return function(t,r){if(r){e=[]}var o=e.some(function(e){return e.intent===t.intent});if(!o){e.push(t);this.getOwnerComponent().getService("ShellUIService").then(function(t){t.setHierarchy(e)})}}}()})});