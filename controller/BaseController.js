sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/UIComponent","sap/m/library","sap/ui/export/Spreadsheet","sap/m/MessageToast"],function(e,t,r,o,a){"use strict";var l=r.URLHelper;return e.extend("com.salesbom.culligan.salesbomdisplay.controller.BaseController",{getRouter:function(){return t.getRouterFor(this)},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,t){return this.getView().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},onShareEmailPress:function(){var e=this.getModel("objectView")||this.getModel("worklistView");l.triggerEmail(null,e.getProperty("/shareSendEmailSubject"),e.getProperty("/shareSendEmailMessage"))},onExcelDownload:function(e){var t,r,l,p;t=e.createColumnConfig();r=e.getView().getModel("OPM").getProperty("/");var n=new Date;l={workbook:{columns:t},dataSource:r,showProgress:false,fileName:"Bill Of Material Report_"+n.getUTCDate()+"-"+(n.getUTCMonth()+1)+"-"+n.getUTCFullYear()};p=new o(l);p.build().then(function(){a.show("Excel export has finished")}).finally(function(){p.destroy()})},createColumnConfig:function(){return[{label:"Header Material",property:"mat",type:sap.ui.export.EdmType.Number},{label:"Father Standard Cost",property:"msp",type:sap.ui.export.EdmType.Number,delimiter:true,scale:3},{label:"Level",property:"lvl",type:sap.ui.export.EdmType.Number},{label:"Is Assembly",property:"asm"},{label:"BOM Usage",property:"usg",type:sap.ui.export.EdmType.Number},{label:"BOM Item No",property:"itm",type:sap.ui.export.EdmType.Number},{label:"BOM Component",property:"bom",type:sap.ui.export.EdmType.Number},{label:"Component Description",property:"des"},{label:"BOM Quantity",property:"qty",type:sap.ui.export.EdmType.Number},{label:"Component Standard Cost",property:"stc",type:sap.ui.export.EdmType.Number,delimiter:true,scale:3},{label:"per Unit Standard Cost",property:"psc",type:sap.ui.export.EdmType.Number,delimiter:true,scale:3},{label:"Total Standard Cost",property:"tsc",type:sap.ui.export.EdmType.Number,delimiter:true,scale:3}]},onSalesExcelDownload:function(e){var t,r,l,p;t=e.salescreateColumnConfig();r=e.getView().getModel("XLSX").getProperty("/");var n=new Date;l={workbook:{columns:t},dataSource:r,showProgress:false,fileName:"Sales Order BOM Report_"+n.getUTCDate()+"-"+(n.getUTCMonth()+1)+"-"+n.getUTCFullYear()};p=new o(l);p.build().then(function(){a.show("Excel export has finished")}).finally(function(){p.destroy()})},salescreateColumnConfig:function(){return[{label:"Sales Order",property:"SalesOrder",type:sap.ui.export.EdmType.Number},{label:"Sales Order Line Item",property:"SalesOrderItem",type:sap.ui.export.EdmType.Number},{label:"Material",property:"Material"},{label:"Category",property:"SalesOrderItemCategory"},{label:"Plant",property:"ProductionPlant"},{label:"Material Description",property:"SalesOrderItemText"},{label:"Customer Material Description",property:"MaterialByCustomer"},{label:"Quantity",property:"RequestedQuantity",type:sap.ui.export.EdmType.Number},{label:"Standard Cost",property:"StandardCost",type:sap.ui.export.EdmType.Number,delimiter:true,scale:3},{label:"Calculated Standard Cost",property:"CalculatedStdCost",type:sap.ui.export.EdmType.Number,delimiter:true,scale:3}]},addHistoryEntry:function(){var e=[];return function(t,r){if(r){e=[]}var o=e.some(function(e){return e.intent===t.intent});if(!o){e.push(t);this.getOwnerComponent().getService("ShellUIService").then(function(t){t.setHierarchy(e)})}}}()})});